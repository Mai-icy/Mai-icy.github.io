<!DOCTYPE html>
<html>
  <head>
     
    <meta charset="UTF-8">
    <title>基于 Oceanbase 简单构建RAG - Mai Icy</title>
    <link rel="shortcut icon" href="/static/img/icon.png">
    <link rel="icon" href="/static/img/icon.png" sizes="192x192"/>
    
<link rel="stylesheet" href="/static/kico.css">
<link rel="stylesheet" href="/static/hingle.css">

    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1"/>
    <meta property="og:site_name" content="Mai Icy">
    <meta property="og:title" content="基于 Oceanbase 简单构建RAG"/>
    
<meta name="generator" content="Hexo 6.2.0"></head>

  <body>
    <header>
    <div class="head-title">
        <h4>Mai Icy</h4>
    </div>
    <div class="head-action">
        <div class="toggle-btn"></div>
        <div class="light-btn"></div>
        <div class="search-btn"></div>
    </div>
    <form class="head-search" method="post">
        <input type="text" name="s" placeholder="搜索什么？">
    </form>
    <nav class="head-menu">
        <a href="/">首页</a>
        <div class="has-child">
            <a>分类</a>
            <div class="sub-menu">
                <a class="category-link" href="/categories/C/">C</a><a class="category-link" href="/categories/python/">python</a><a class="category-link" href="/categories/rust/">rust</a><a class="category-link" href="/categories/%E5%A4%A7%E6%A8%A1%E5%9E%8B/">大模型</a><a class="category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a><a class="category-link" href="/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">算法学习笔记</a><a class="category-link" href="/categories/%E7%AE%97%E6%B3%95%E8%AF%BE%E7%AC%94%E8%AE%B0/">算法课笔记</a><a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/">计算机网络笔记</a>
            </div>
        </div>
        
            <a href="/about">关于我</a>
        
            <a href="/friends">朋友们</a>
        
    </nav>
</header>

    <main>
    <div class="wrap min">
        <section class="post-title">
            <h2>基于 Oceanbase 简单构建RAG</h2>
            <div class="post-meta">
                <time class="date">2025.06.04</time>
            
            </div>
        </section>
        <article class="post-content">
        
            <h2 id="背景：从黑客松到实践">背景：从黑客松到实践</h2>
<p>在参加 OceanBase 黑客松的过程中，我初次接触到了 OceanBase 向量检索能力，深感其在构建智能知识服务系统中的潜力。恰逢 OceanBase 提供了一年的免费数据库使用额度，我便以 OI-Wiki 为语料，构建了一个简单但实用的智能体系统。</p>
<p>我们使用了阿里云的 百炼大模型平台，配合 OceanBase 数据库，完成了一个具备语义理解与检索问答能力的系统。</p>
<h2 id="系统目标与设计">系统目标与设计</h2>
<p>项目目标是：</p>
<p>让用户可以使用自然语言，快速提问 OI-Wiki 中的算法知识，系统能给出准确、可追溯的回答。有以下结果图：</p>
<p><img src="/2025/06/04/%E5%9F%BA%E4%BA%8EOceanbase%E7%AE%80%E5%8D%95%E6%9E%84%E5%BB%BARAG/1.png" alt="image.png"></p>
<h3 id="系统结构简述：">系统结构简述：</h3>
<ul>
<li>数据源：拉取OI-wiki的仓库</li>
<li>向量数据库：使用 OceanBase 存储向量化内容，并根据板块进行分区管理</li>
<li>大模型能力：基于百炼平台，提供智能体</li>
<li>前端交互：采用 Streamlit 快速构建问答界面</li>
</ul>
<h3 id="检索流程：">检索流程：</h3>
<ul>
<li>用户输入 → 意图识别 → 板块判定 → OceanBase 检索候选文段</li>
<li>检索结果 + 问题 → 送入大模型进行最终回答（带引用）</li>
</ul>
<h2 id="自然语言处理部分：理解用户意图">自然语言处理部分：理解用户意图</h2>
<p>在这个阶段，我们关注如何理解用户的自然语言问题：</p>
<ol>
<li>
<p><strong>意图识别</strong></p>
<p>判断用户提问是否为“算法类”问题，避免模型误判生活类问题。</p>
</li>
<li>
<p><strong>文本分类/板块识别</strong></p>
<p>基于模型推理判断该问题涉及 OI-Wiki 中的哪个板块，例如“图论”“字符串”“数学”等，以便快速分区检索。</p>
</li>
<li>
<p><strong>查询改写</strong></p>
<p>对用户的问题进行语义增强与重写，提升检索时的匹配精度。</p>
</li>
</ol>
<p>对此我们将智能体分成三个：</p>
<p>也就是 意图分析+改写 Agent，板块识别 Agent，知识库回答 Agent。</p>
<p>其中我们的智能体仅仅通过提示词进行区别。</p>
<h3 id="意图分析-改写">意图分析+改写</h3>
<p>首先我们将意图分成三种：聊天，算法，信息查询。</p>
<p>对于聊天，也就是不需要任何知识库知识的内容，完全借助大语言模型即可。</p>
<p>对于算法，需要更多逻辑推理的过程，要求强调多逻辑结合推理。</p>
<p>对于信息查询，需要更多严谨按照信息，不能虚假构造。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">INTENT_PROMPT <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
你是一个专注于回答 算法竞赛相关 问题的机器人。
你的目标是根据用户的提问，判断用户的问题是闲聊、算法问题 还是 赛事或编程工具或语言问题，如果不是闲聊，则把问题改写成适合进行文档检索的形式，并提取出用户问题所涉及的 算法板块。

用户可能会向你提出有关 算法竞赛 的问题，也可能会进行闲聊。其中，算法竞赛 的问题也区分为多种类型，有些是算法问题，有些是赛事或编程工具或语言问题。

算法问题需要一些逻辑和推理，主要以算法介绍为主，提供查询和教学。
其他问题以文档查询为主，结合用户的上下文，把文档中内的内容提供给用户。

注意，包含类似(大小写等区别)下列关键词或者其内容的的也属于 算法问题 的问题 （属于Algorithm类型）
下面是对算法问题多个分类板块的介绍：

介绍略 见下面那个提示词 不然博客太长了 :D

请根据用户的提问，判断用户的问题类型，并将问题分类为以下几类：
1. Chat
2. Algorithm
3. Other

判断完问题之后，将与 非聊天 的问题进行改写，使其更适合用来进行文档检索。

改写策略：
- 闲聊类型的问题改写为“无”
- 修正显著的中文或英语拼写错误
- 依据以下对话上下文，推断出用户的意图，改写用户不具体的提问。

并提取出用户问题所涉及的 算法板块，例如 Basic、DP、DS、Geometry、Graph、Math、Misc、Search、String、Topic等。(需要出现在上述面的列表里，问题中占比越高的组件在输出的列表里排序越靠前)

输出必须是按照以下格式化的 json 代码片段，不加额外的 json 标识，type 表示问题分类，rewrite 表示改写后的问题，components 表示用户问题所涉及的 OceanBase 相关组件。
&#123;&#123;
  "type": string,
  "rewrite": string,
  "components:" [string]
&#125;&#125;

案例1:
用户问题: “我想知道动态规划的一些常用分类”
&#123;&#123;
  "type": "Algorithm",
  "rewrite": "动态规划的一些常见使用",
  "components": ["DP"]
&#125;&#125;

案例2:
用户问题: “你好”
&#123;&#123;
  "type": "Chat",
  "rewrite": "无",
  "components": []
&#125;&#125;

接下来回答用户的问题吧！
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="板块分析">板块分析</h3>
<p>我们将板块进行分类，结合oiwiki上的知识，可以分成10个板块，对于每个板块都要有一定的说明，尽量精炼，并能给出一些简单的示例。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">SECTION_PROMPT <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
你是一个专注于回答 算法竞赛 问题的 DBA。
你的目标是根据 算法板块和其他问题 的板块描述描述和用户的提问，判断相关的 算法板块或者 其它的文档内容板块，以便后续查阅文档回答用户，并按照指定的 JSON 格式进行输出。

下面是对算法问题多个分类板块的介绍：
1. Basic（基础算法）：基础算法和技术，包括常见排序算法（如快速排序、归并排序）、复杂度分析（如时间复杂度、空间复杂度）、以及贪心算法、分治法等核心算法思想和方法，适用于大多数基础算法问题。
2. DP (动态规划)：动态规划的核心思想和技术，涉及如何将问题分解为子问题并通过记忆化或状态转移方程进行求解。包括经典问题如背包问题、数位DP、树形DP等。
3. DS (数据结构)：数据结构的基本和进阶内容，涵盖从简单的链表、栈、队列到复杂的树（如AVL树、B树、Trie树）和图（如并查集、最短路径算法）等数据结构的实现及应用。
4. Geometry (几何)：几何算法的常见应用，包括计算几何问题如凸包、最近点对、几何中的平面扫描、旋转卡尺等方法，广泛用于几何形状和空间问题的处理。
5. Graph (图论)：图算法的基本技术，包含图的遍历（DFS、BFS）、最短路径算法（Dijkstra、Bellman-Ford）、最小生成树（Prim、Kruskal）、网络流等问题的解决方法，广泛应用于网络、拓扑排序等问题。
6. Math (数学)：数学问题的解决方法，包括数论算法（如质数筛法、欧几里得算法）、线性代数、矩阵运算、高斯消元法、排列组合、概率等，适用于需要数学推导和计算的算法题。
7. Misc (杂项)：包含一些特殊问题的解决方案或技巧，如模拟算法、模拟退火、贪心算法的变种、回滚技术、空间优化技巧等，适用于一些特殊的算法和策略问题。
8. Search (搜索)：搜索类问题的解决方法，包括图的搜索（DFS、BFS）、启发式搜索（A*）、回溯法、递归搜索、深度优先搜索（DFS）优化等，广泛应用于路径规划、解空间搜索等问题。
9. String (字符串)：字符串处理算法，包括字符串匹配（如KMP、AC自动机）、字符串哈希、最小表示法、字典树等，用于高效地处理文本搜索和字符串相关问题。
10. Topic (专题)：特定领域的算法和技术，包括动态树、网络流专题、计算几何专题等，涉及一些独立而深入的算法主题，通常需要更高的技术深度来解决。

下面是对赛事或编程工具或语言板块：（属于Other类型）
1. Contest (算法竞赛问题): 算法竞赛的赛制，规则，一些知名的算法竞赛详情，对于算法竞赛中常见错误的原因，提交代码等等与竞赛相关的问题
2. Tools (编程工具问题): 一些编程常用工具，算法竞赛选手常用的工具，特殊交互问题的工具等等
3. Lang (编程语言问题): 语言中的一些特性问题，包括函数，指针等等编程语言的基础知识。

目前支持的板块文档库如下: (以["板块1", "板块2", ...]的形式传入)
["Basic", "DP", "DS", "Geometry", "Graph", "Math", "Misc", "Search", "String", "Topic", "Contest", "Tools", "Lang"]

请根据 算法板块和其他问题 的板块描述描述和用户的提问，判断相关的 算法板块和相关板块，以便后续查阅文档回答用户，并按照指定的 JSON 格式进行输出。
输出要求: 不要用代码块包裹，直接输出 JSON 格式的字符串，提供的板块一定要在支持的板块列表里！禁止杜撰和捏造。

输出格式如下: 
&#123;&#123;
  "components": ["板块1", "板块2", ...] (如果有的话，否则为空数组)
&#125;&#125;

示例 1: 
用户问题: 逆元怎么计算？
输出: 
&#123;&#123;
  "components": ["Math"]
&#125;&#125;

示例 2: 
用户问题: 算法竞赛有哪些，支持什么语言？
输出:
&#123;&#123;
  "components": ["Contest", "Tools", "Lang"]
&#125;&#125;

接下来开始吧!
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="知识库回答">知识库回答</h3>
<p>提供一个嵌入，可以把我们的知识库相关内容嵌入进去，再提供一些简单的回答要求，当然可以自行优化。这里只是一个简单的例子。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">RAG_PROMPT <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
你是一个专注于回答用户问题的助手。
你的目标是利用可能存在的历史对话和检索到的文档片段，回答用户的问题。
任务描述：根据可能存在的历史对话、用户问题和检索到的文档片段，尝试回答用户问题。如果所有文档都无法解决用户问题，首先考虑用户问题的合理性。如果用户问题不合理，需要进行纠正。如果用户问题合理但找不到相关信息，则表示抱歉并给出基于内在知识的可能解答。如果文档中的信息可以解答用户问题，则根据文档信息严格回答问题。

下面是检索到的相关文档片段，切记不要编造事实：
&#123;document_snippets&#125;

回答要求：
- 如果所有文档都无法解决用户问题，首先考虑用户问题的合理性。如果用户问题不合理，请回答：“您的问题可能存在误解，实际上据我所知……（提供正确的信息）”。如果用户问题合理但找不到相关信息，请回答：“抱歉，无法从检索到的文档中找到解决此问题的信息。”
- 如果文档中的信息可以解答用户问题，请回答：“根据文档库中的信息，……（严格依据文档信息回答用户问题）”。如果答案可以在某一篇文档中找到，请在回答时直接指出依据的文档名称及段落的标题(不要指出片段标号)。
- 如果某个文档片段中包含代码，请务必引起重视，给用户的回答中尽可能包含代码。请完全参考文档信息回答用户问题，不要编造事实。
- 如果需要综合多个文档中的片段信息，请全面地总结理解后尝试给出全面专业的回答。
- 尽可能分点并且详细地解答用户的问题，回答不宜过短。
- 不要在回答中给出任何参考文档的链接，提供给你的文档片段中的链接相对路径是有误的。
- 不要用"具体信息可参考以下文档片段"这样的话来引导用户查看文档片段。

下面请根据上述要求直接给出你对于用户问题的回答。"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="结合构建流程">结合构建流程</h3>
<p>通过三个提示词构建出三个智能体，并通过提示词的方式让ai以 json的格式返回数据以供使用。</p>
<p>有了这三个智能体之后，就可以通过三个智能体构建出一个简单的问答流程图：</p>
<pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid"><span class="token keyword">flowchart</span> TD
    A<span class="token text string">[用户输入问题]</span> <span class="token arrow operator">--></span> B<span class="token text string">&#123;意图分析Agent&#125;</span>
    B <span class="token arrow operator">--></span> C1<span class="token text string">[日常]</span>
    B <span class="token arrow operator">--></span> C2<span class="token text string">[算法]</span>
    B <span class="token arrow operator">--></span> C3<span class="token text string">[信息询问]</span>

    C1 <span class="token arrow operator">--></span> D1<span class="token text string">[大模型直接回复]</span>

    C2 <span class="token arrow operator">--></span> E<span class="token text string">[板块分析模块]</span>
    C3 <span class="token arrow operator">--></span> E

    E <span class="token arrow operator">--></span> F<span class="token text string">[获取对应板块]</span>
    F <span class="token arrow operator">--></span> G<span class="token text string">[RAG回答智能体回复]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里当然还有一些优化点，比如算法，可以进入算法回复智能体，信息询问，进入信息询问智能体，他们可以针对自己的问题，有不同的回答方式。</p>
<h2 id="知识库构建与检索">知识库构建与检索</h2>
<p>我们既然已经构建好了一个回答的流程，那接下来就可以选择我们的知识库构建方案了，接下来的方案是使用OceanBase的向量存储功能，会给出两个主要的核心函数。</p>
<h3 id="OceanBase的连接">OceanBase的连接</h3>
<p>推荐使用环境变量的方式进行导入，只需要这些项，就可以进行数据库的连接了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dotenv<span class="token punctuation">.</span>load_dotenv<span class="token punctuation">(</span><span class="token punctuation">)</span>

connection_args <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"host"</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_HOST"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"port"</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_PORT"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"user"</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_USER"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"password"</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_PASSWORD"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"%40"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_PASSWORD"</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string">"db_name"</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"DB_NAME"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

instance <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">connect_oceanbase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> OceanbaseVectorStore<span class="token punctuation">:</span>
    <span class="token keyword">global</span> instance
    <span class="token keyword">if</span> instance <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        instance <span class="token operator">=</span> OceanbaseVectorStore<span class="token punctuation">(</span>
            embedding_function<span class="token operator">=</span>get_embedding<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            table_name<span class="token operator">=</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"TABLE_NAME"</span><span class="token punctuation">,</span> <span class="token string">"corpus"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            connection_args<span class="token operator">=</span>connection_args<span class="token punctuation">,</span>
            metadata_field<span class="token operator">=</span><span class="token string">"metadata"</span><span class="token punctuation">,</span>
            extra_columns<span class="token operator">=</span><span class="token punctuation">[</span>Column<span class="token punctuation">(</span><span class="token string">"section_code"</span><span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            partitions<span class="token operator">=</span>ObListPartition<span class="token punctuation">(</span>
                is_list_columns<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                list_part_infos<span class="token operator">=</span><span class="token punctuation">[</span>RangeListPartInfo<span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> cm<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                                <span class="token operator">+</span> <span class="token punctuation">[</span>RangeListPartInfo<span class="token punctuation">(</span><span class="token string">"p10"</span><span class="token punctuation">,</span> <span class="token string">"DEFAULT"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                list_expr<span class="token operator">=</span><span class="token string">"section_code"</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">return</span> instance<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首次调用时，初始化一个 <code>OceanbaseVectorStore</code> 实例，参数如下：</p>
<ul>
<li>
<p><code>embedding_function=get_embedding()</code>: 使用你定义的嵌入函数。</p>
</li>
<li>
<p><code>table_name=os.getenv(&quot;TABLE_NAME&quot;, &quot;corpus&quot;)</code>: 从环境变量获取表名，默认是 <code>&quot;corpus&quot;</code>。</p>
</li>
<li>
<p><code>connection_args=connection_args</code>: 使用你预先定义的 OceanBase 连接参数。</p>
</li>
<li>
<p><code>metadata_field=&quot;metadata&quot;</code>: 将元数据存储在名为 <code>&quot;metadata&quot;</code> 的列中。</p>
</li>
<li>
<p><code>extra_columns=[Column(&quot;section_code&quot;, Integer, primary_key=True)]</code>: 添加一个额外的整型主键列 <code>section_code</code>。</p>
</li>
<li>
<pre><code>partitions=ObListPartition(...)
<pre class="line-numbers language-none"><code class="language-none">
: 使用 列表分区策略 按 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
section_code
<pre class="line-numbers language-none"><code class="language-none">
   分区，其中：

  - &#96;list_part_infos&#96; 是多个 &#96;RangeListPartInfo&#96; 组成的列表，&#96;cm&#96; 是你的某个字典，用来定义分区。
  - &#96;&quot;p10&quot;&#96; 是默认分区。
  - &#96;list_expr&#x3D;&quot;section_code&quot;&#96; 指定用于分区的字段。

### 优化数据库的使用参数

oceanbase有使用向量数据库的推荐参数，根据连接后使用以下参数也可以完成：

&#96;&#96;&#96;python
def optimize_ob_args():
    vals &#x3D; []
    params &#x3D; ob.obvector.perform_raw_text_sql(
        &quot;SHOW PARAMETERS LIKE &#39;%ob_vector_memory_limit_percentage%&#39;&quot;
    )
    for row in params:
        val &#x3D; int(row[6])
        vals.append(val)
    if len(vals) &#x3D;&#x3D; 0:
        print(&quot;ob_vector_memory_limit_percentage not found in parameters.&quot;)
        exit(1)
    if any(val &#x3D;&#x3D; 0 for val in vals):
        try:
            ob.obvector.perform_raw_text_sql(
                &quot;ALTER SYSTEM SET ob_vector_memory_limit_percentage &#x3D; 30&quot;
            )
        except Exception as e:
            print(&quot;Failed to set ob_vector_memory_limit_percentage to 30.&quot;)
            print(&quot;Error message:&quot;, e)
            exit(1)
    ob.obvector.perform_raw_text_sql(&quot;SET ob_query_timeout&#x3D;100000000&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</code></pre>
</li>
</ul>
<h3 id="数据处理流程">数据处理流程</h3>
<p>先进行数据的处理</p>
<ol>
<li>爬取 &amp; 清洗：爬取 OI-Wiki 的 Markdown 内容，转为纯文本；</li>
<li>切块 &amp; 嵌入：将文本进行分段，使用嵌入模型（如百炼提供的 <code>text-embedding</code>）转为向量；</li>
<li>存入 OceanBase：按板块分区建表，将向量写入 OceanBase；</li>
<li>构建索引：使用近似向量搜索机制，提高查询效率。</li>
</ol>
<p>对于构建索引和嵌入，可以使用add_document方法，以下是一个插入的例子，我已经分块，并且在插入的时候进行的分类，同时，他会在插入的时候，把文件路径作为元数据传入，到时候可以借助元数据来进行参考资源的定位。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">insert_batch</span><span class="token punctuation">(</span>docs<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Document<span class="token punctuation">]</span><span class="token punctuation">,</span> section<span class="token punctuation">)</span><span class="token punctuation">:</span>
    code <span class="token operator">=</span> section_map<span class="token punctuation">[</span>section<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> code<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"section </span><span class="token interpolation"><span class="token punctuation">&#123;</span>section<span class="token punctuation">&#125;</span></span><span class="token string"> not found in section_map."</span></span><span class="token punctuation">)</span>

    ob<span class="token punctuation">.</span>add_documents<span class="token punctuation">(</span>
        docs<span class="token punctuation">,</span>
        ids<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        extras<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"section_code"</span><span class="token punctuation">:</span> code<span class="token punctuation">&#125;</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> docs<span class="token punctuation">]</span><span class="token punctuation">,</span>
        partition_name<span class="token operator">=</span>section<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">insert_oi_wiki</span><span class="token punctuation">(</span>file_dir<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> partition_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    batch_size <span class="token operator">=</span> <span class="token number">4</span>
    limit <span class="token operator">=</span> <span class="token number">300</span>

    batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    loader <span class="token operator">=</span> MarkdownDocumentsLoader<span class="token punctuation">(</span>file_dir<span class="token punctuation">)</span>
    <span class="token keyword">for</span> doc <span class="token keyword">in</span> loader<span class="token punctuation">.</span>load<span class="token punctuation">(</span>limit<span class="token operator">=</span>limit<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>batch<span class="token punctuation">)</span> <span class="token operator">==</span> batch_size<span class="token punctuation">:</span>
            insert_batch<span class="token punctuation">(</span>batch<span class="token punctuation">,</span> partition_name<span class="token punctuation">)</span>
            batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        batch<span class="token punctuation">.</span>append<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>batch<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        insert_batch<span class="token punctuation">(</span>batch<span class="token punctuation">,</span> partition_name<span class="token punctuation">)</span>
        
        
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    optimize_ob_args<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\basic", "Basic")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\dp", "DP")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\ds", "DS")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\geometry", "Geometry")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\graph", "Graph")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\math", "Math")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\misc", "Misc")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\search", "Search")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\string", "String")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\topic", "Topic")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\contest", "Contest")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\lang", "Lang")</span>
    <span class="token comment"># insert_oi_wiki("doc\\\\docs\\\\tools", "Tools")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>docs</code>: 一组待插入的 <code>Document</code> 对象，来自 <code>langchain_core.documents.Document</code>。</li>
<li><code>ids=[...]</code>: 生成一组随机的唯一 ID（UUID 格式），作为文档的主键（<code>id</code> 字段）。如果不指定，系统可能默认生成。</li>
<li><code>extras=[...]</code>: 额外列字段内容，这里是设置每个文档的 <code>section_code</code>，必须与你建表时定义的 <code>extra_columns=[Column(&quot;section_code&quot;, Integer, primary_key=True)]</code> 相匹配。</li>
<li><code>partition_name=section</code>: 指定将这些文档写入名为 <code>section</code> 的分区（你使用了 <code>ObListPartition</code> 分区策略时定义了多个 <code>section_code</code> 映射的分区名）。</li>
</ul>
<h3 id="向量查询">向量查询</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">doc_search_by_vector</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">]</span><span class="token punctuation">,</span> partition_names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> limit<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">[</span>Document<span class="token punctuation">]</span><span class="token punctuation">:</span>
    oceanbase <span class="token operator">=</span> connect_oceanbase<span class="token punctuation">(</span><span class="token punctuation">)</span>

    docs <span class="token operator">=</span> oceanbase<span class="token punctuation">.</span>similarity_search_by_vector<span class="token punctuation">(</span>
        embedding<span class="token operator">=</span>vector<span class="token punctuation">,</span>
        k<span class="token operator">=</span>limit<span class="token punctuation">,</span>
        partition_names<span class="token operator">=</span>partition_names<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> docs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p><strong><code>vector: list[float]</code></strong></p>
<p>用于检索的嵌入向量（embedding），一般是通过 <code>embedding_model.embed_query(text)</code> 得到的。</p>
</li>
<li>
<p><strong><code>partition_names: Optional[list[str]]</code></strong></p>
<p>只在指定的分区中检索。如果你对表做了分区（如按章节、模块划分），可以精确控制查找范围。</p>
<p>默认 <code>None</code> 表示不指定分区，查询全表。</p>
</li>
<li>
<p><strong><code>limit: int = 10</code></strong></p>
<p>返回相似度最高的前 <code>k</code> 条记录，默认值是 10。</p>
</li>
</ul>
<p>这样的话就可以通过ob进行基本的流程处理了。</p>
<p>接下来我们可以进行整合</p>
<h2 id="流程整合">流程整合</h2>
<p>这是我整合的一个基于 RAG的流式问答核心函数 <code>doc_rag_stream</code>。它的主要目的是结合用户的历史对话上下文与当前提问，通过意图识别判断是否需要检索文档，如果需要，则会进一步识别所属知识板块，并使用深度学习模型将问题嵌入为向量，调用 OceanBase 中构建的向量数据库检索相关文档片段，最后将这些文档提供给大语言模型进行上下文增强的生成回复。</p>
<p>整个流程是流式的，用户可以实时看到检索进度和生成过程中的中间信息。同时，为了提升可读性与溯源性，我还实现了对模型生成结果中的文档引用标记（如[@1]）的识别与替换，自动链接到原始知识文档，并在末尾列出引用列表。这种设计不仅提升了模型生成内容的可信度，也方便用户深入阅读相关知识片段。整体架构充分结合了深度学习、数据库检索与流式生成的优势，是我在项目中对 RAG 应用的一个完整实现。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">doc_rag_stream</span><span class="token punctuation">(</span>
    query<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span>
    chat_history<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    llm_model<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span>
    universal_rag<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
    search_docs<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
    <span class="token operator">**</span>kwargs<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Iterator<span class="token punctuation">[</span>Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> AIMessageChunk<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    all_sections <span class="token operator">=</span> section_map<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>

    intent_agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>prompt<span class="token operator">=</span>INTENT_PROMPT<span class="token punctuation">,</span> llm_model<span class="token operator">=</span>llm_model<span class="token punctuation">)</span>
    rag_agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>prompt<span class="token operator">=</span>RAG_PROMPT<span class="token punctuation">,</span> llm_model<span class="token operator">=</span>llm_model<span class="token punctuation">)</span>
    section_agent <span class="token operator">=</span> Agent<span class="token punctuation">(</span>prompt<span class="token operator">=</span>SECTION_PROMPT<span class="token punctuation">,</span> llm_model<span class="token operator">=</span>llm_model<span class="token punctuation">)</span>
    embedding <span class="token operator">=</span> get_embedding<span class="token punctuation">(</span><span class="token punctuation">)</span>

    query_with_history <span class="token operator">=</span> <span class="token string">"\\n"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>msg<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> msg <span class="token keyword">in</span> chat_history <span class="token keyword">if</span> msg<span class="token punctuation">[</span><span class="token string">"role"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    query_with_history <span class="token operator">+=</span> <span class="token string">"\\n"</span> <span class="token operator">+</span> query

    <span class="token keyword">def</span> <span class="token function">message_with_time</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">nonlocal</span> start_time
        cur_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        elapsed_time <span class="token operator">=</span> cur_time <span class="token operator">-</span> start_time
        start_time <span class="token operator">=</span> cur_time
        <span class="token keyword">return</span> text <span class="token operator">+</span> <span class="token string">"（耗时 &#123;:.2f&#125; 秒）"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>elapsed_time<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> search_docs<span class="token punctuation">:</span>
        <span class="token keyword">yield</span> <span class="token boolean">None</span>
        <span class="token keyword">yield</span> <span class="token keyword">from</span> rag_agent<span class="token punctuation">.</span>stream<span class="token punctuation">(</span>query<span class="token punctuation">,</span> chat_history<span class="token punctuation">,</span> document_snippets<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>

    <span class="token keyword">if</span> universal_rag<span class="token punctuation">:</span>
        <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string">"正在使用深度学习模型将提问内容嵌入为向量..."</span><span class="token punctuation">)</span>
        query_embedded <span class="token operator">=</span> embedding<span class="token punctuation">.</span>embed_query<span class="token punctuation">(</span>query<span class="token punctuation">)</span>

        <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string">"正在使用 OceanBase 检索相关文档..."</span><span class="token punctuation">)</span>
        docs <span class="token operator">=</span> doc_search_by_vector<span class="token punctuation">(</span>
            query_embedded<span class="token punctuation">,</span>
            limit<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> <span class="token string">"正在分析问题的意图..."</span>

        intent <span class="token operator">=</span> intent_agent<span class="token punctuation">.</span>invoke_json<span class="token punctuation">(</span>query<span class="token punctuation">)</span>
        intent_type <span class="token operator">=</span> intent<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"Algorithm"</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> intent_type <span class="token operator">==</span> <span class="token string">"Chat"</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string">"没有算法相关内容"</span><span class="token punctuation">)</span>
            <span class="token keyword">yield</span> <span class="token boolean">None</span>
            <span class="token keyword">yield</span> <span class="token keyword">from</span> rag_agent<span class="token punctuation">.</span>stream<span class="token punctuation">(</span>query<span class="token punctuation">,</span> chat_history<span class="token punctuation">,</span> document_snippets<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        section <span class="token operator">=</span> section_agent<span class="token punctuation">.</span>invoke_json<span class="token punctuation">(</span>query_with_history<span class="token punctuation">)</span>
        sections<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> section<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"components"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"Basic"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        sections <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>sec <span class="token keyword">for</span> sec <span class="token keyword">in</span> sections <span class="token keyword">if</span> sec <span class="token keyword">in</span> all_sections<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">yield</span> <span class="token string">"列出相关板块"</span> <span class="token operator">+</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>sections<span class="token punctuation">)</span>

        <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string">"正在使用深度学习模型将提问内容嵌入为向量..."</span><span class="token punctuation">)</span>
        query_embedded <span class="token operator">=</span> embedding<span class="token punctuation">.</span>embed_query<span class="token punctuation">(</span>query<span class="token punctuation">)</span>

        total_docs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> sec <span class="token keyword">in</span> sections<span class="token punctuation">:</span>
            <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"正在使用 OceanBase 检索 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>sec<span class="token punctuation">&#125;</span></span><span class="token string"> 的相关文档..."</span></span><span class="token punctuation">)</span>
            total_docs<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>doc_search_by_vector<span class="token punctuation">(</span>query_embedded<span class="token punctuation">,</span> <span class="token punctuation">[</span>sec<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        docs <span class="token operator">=</span> total_docs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>

    <span class="token keyword">yield</span> message_with_time<span class="token punctuation">(</span><span class="token string">"大语言模型正在思考..."</span><span class="token punctuation">)</span>

    docs_content <span class="token operator">=</span> <span class="token string">"\\n=====\\n"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
        <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"文档片段:\\n\\n"</span></span> <span class="token operator">+</span> chunk<span class="token punctuation">.</span>page_content <span class="token keyword">for</span> i<span class="token punctuation">,</span> chunk <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>

    ans_itr <span class="token operator">=</span> rag_agent<span class="token punctuation">.</span>stream<span class="token punctuation">(</span>query<span class="token punctuation">,</span> chat_history<span class="token punctuation">,</span> document_snippets<span class="token operator">=</span>docs_content<span class="token punctuation">)</span>

    visited <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token builtin">buffer</span><span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">""</span>
    pruned_references <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    get_first_token <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">for</span> chunk <span class="token keyword">in</span> ans_itr<span class="token punctuation">:</span>
        <span class="token builtin">buffer</span> <span class="token operator">+=</span> chunk<span class="token punctuation">.</span>content
        <span class="token keyword">if</span> <span class="token string">"["</span> <span class="token keyword">in</span> <span class="token builtin">buffer</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">buffer</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">:</span>
            matches <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"(\\[+\\@(\\d+)\\]+)"</span><span class="token punctuation">,</span> <span class="token builtin">buffer</span><span class="token punctuation">)</span>
            <span class="token comment"># [('[@1]', '1'), ('[@23]', '23')]</span>
            <span class="token keyword">if</span> matches<span class="token punctuation">:</span>
                <span class="token builtin">sorted</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                <span class="token keyword">for</span> m<span class="token punctuation">,</span> order <span class="token keyword">in</span> matches<span class="token punctuation">:</span>
                    doc <span class="token operator">=</span> docs<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
                    meta <span class="token operator">=</span> DocumentMeta<span class="token punctuation">.</span>model_validate<span class="token punctuation">(</span>doc<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>

                    doc_name <span class="token operator">=</span> meta<span class="token punctuation">.</span>doc_name
                    doc_url <span class="token operator">=</span> meta<span class="token punctuation">.</span>doc_url<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"doc\\\\docs"</span><span class="token punctuation">,</span> <span class="token string">"&lt;https://oi-wiki.org/>"</span><span class="token punctuation">)</span>\\
                                          <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\\\\"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>\\
                                          <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">".md"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                    idx <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span>
                    <span class="token keyword">if</span> doc_url <span class="token keyword">in</span> visited<span class="token punctuation">:</span>
                        idx <span class="token operator">=</span> visited<span class="token punctuation">[</span>doc_url<span class="token punctuation">]</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        visited<span class="token punctuation">[</span>doc_url<span class="token punctuation">]</span> <span class="token operator">=</span> idx
                        doc_text <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">. [</span><span class="token interpolation"><span class="token punctuation">&#123;</span>doc_name<span class="token punctuation">&#125;</span></span><span class="token string">](</span><span class="token interpolation"><span class="token punctuation">&#123;</span>doc_url<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span>
                        pruned_references<span class="token punctuation">.</span>append<span class="token punctuation">(</span>doc_text<span class="token punctuation">)</span>
                        count <span class="token operator">+=</span> <span class="token number">1</span>

                    ref_text <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"[[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">]](</span><span class="token interpolation"><span class="token punctuation">&#123;</span>doc_url<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span>
                    <span class="token builtin">buffer</span> <span class="token operator">=</span> <span class="token builtin">buffer</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>m<span class="token punctuation">,</span> ref_text<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> get_first_token<span class="token punctuation">:</span>
            get_first_token <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">yield</span> <span class="token boolean">None</span>

        <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>
        <span class="token builtin">buffer</span> <span class="token operator">=</span> <span class="token string">""</span>

    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">buffer</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>

    ref_tip <span class="token operator">=</span> <span class="token string">"根据向量相似性匹配检索到的相关文档如下:"</span>

    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pruned_references<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"\\n\\n"</span> <span class="token operator">+</span> ref_tip<span class="token punctuation">)</span>

        <span class="token keyword">for</span> ref <span class="token keyword">in</span> pruned_references<span class="token punctuation">:</span>
            <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"\\n"</span> <span class="token operator">+</span> ref<span class="token punctuation">)</span>

    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"\\n\\n"</span> <span class="token operator">+</span> ref_tip<span class="token punctuation">)</span>

        visited <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">for</span> doc <span class="token keyword">in</span> docs<span class="token punctuation">:</span>
            meta <span class="token operator">=</span> DocumentMeta<span class="token punctuation">.</span>model_validate<span class="token punctuation">(</span>doc<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>
            doc_name <span class="token operator">=</span> meta<span class="token punctuation">.</span>doc_name
            doc_url <span class="token operator">=</span> meta<span class="token punctuation">.</span>doc_url<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"doc\\\\docs"</span><span class="token punctuation">,</span> <span class="token string">"&lt;https://oi-wiki.org/>"</span><span class="token punctuation">)</span> \\
                <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\\\\"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span> \\
                <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">".md"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> doc_url <span class="token keyword">in</span> visited<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            visited<span class="token punctuation">[</span>doc_url<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
            count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>visited<span class="token punctuation">)</span>
            doc_text <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>count<span class="token punctuation">&#125;</span></span><span class="token string">. [</span><span class="token interpolation"><span class="token punctuation">&#123;</span>doc_name<span class="token punctuation">&#125;</span></span><span class="token string">](</span><span class="token interpolation"><span class="token punctuation">&#123;</span>doc_url<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span>
            <span class="token keyword">yield</span> AIMessageChunk<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"\\n"</span> <span class="token operator">+</span> doc_text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
        </article>
        <section class="post-near">
            <ul>
                
                    <li>上一篇: <a href="/2025/06/08/Java%20Web%20%E6%A6%82%E8%BF%B0%E5%92%8C%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86/">Java Web 概述和基本认识</a></li>
                
                
                    <li>下一篇: <a href="/2025/04/29/%E5%9C%A8%20surfacebook2%20%E4%B8%8A%E5%AE%89%E8%A3%85%20ubuntu%20%E5%8F%8C%E7%B3%BB%E7%BB%9F/">在 surfacebook2 上安装 ubuntu 双系统</a></li>
                
            </ul>
        </section>
        
            <section class="post-tags">
            <a class="-none-link" href="/tags/RAG/" rel="tag">RAG</a>
            </section>
        
    
        <section class="post-author">
        
            <figure class="author-avatar">
                <img src="https://avatars.githubusercontent.com/u/62082723" alt="Mai Icy" />
            </figure>
        
            <div class="author-info">
                <h4>Mai Icy</h4>
                <p>wwwwwww</p>
            </div>
        </section>
    
    </div>
</main>

    <footer>
    <div class="buttons">
        <a class="to-top" href="#"></a>
    </div>
    <div class="wrap min">
        <section class="widget">
            <div class="row">
                <div class="col-m-4">
                    <h3 class="title-recent">最新文章：</h3>
                    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2025/06/15/computer-network-note10/">计算机网络笔记10——传输层重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/06/08/Java%20Web%20%E6%A6%82%E8%BF%B0%E5%92%8C%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86/">Java Web 概述和基本认识</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/06/04/%E5%9F%BA%E4%BA%8EOceanbase%E7%AE%80%E5%8D%95%E6%9E%84%E5%BB%BARAG/">基于 Oceanbase 简单构建RAG</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/29/%E5%9C%A8%20surfacebook2%20%E4%B8%8A%E5%AE%89%E8%A3%85%20ubuntu%20%E5%8F%8C%E7%B3%BB%E7%BB%9F/">在 surfacebook2 上安装 ubuntu 双系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/21/%E4%BD%BF%E7%94%A8%20Bind%20%E6%90%AD%E5%BB%BA%20DNS%20%E6%9C%8D%E5%8A%A1%E5%99%A8/">使用 Bind 搭建 DNS 服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/14/MCP%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D/">MCP协议介绍</a></li></ul>
                </div>
                <div class="col-m-4">
                    <h3 class="title-date">时光机：</h3>
                    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/04/">April 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li></ul>
                </div>
                <div class="col-m-4">
                    <h3 class="title-tags">标签云：</h3>
                    <a href="/tags/2-SAT/" style="font-size: 10px;">2-SAT</a> <a href="/tags/3D-3D-ICP/" style="font-size: 10px;">3D-3D:ICP</a> <a href="/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/" style="font-size: 10px;">AC自动机</a> <a href="/tags/ARISE%E4%BC%98%E5%8C%96/" style="font-size: 10px;">ARISE优化</a> <a href="/tags/B-%E6%A0%91/" style="font-size: 10px;">B+树</a> <a href="/tags/BitTorrent/" style="font-size: 10px;">BitTorrent</a> <a href="/tags/C/" style="font-size: 11.43px;">C</a> <a href="/tags/CDN/" style="font-size: 10px;">CDN</a> <a href="/tags/CDQ%E5%88%86%E6%B2%BB/" style="font-size: 10px;">CDQ分治</a> <a href="/tags/DNS/" style="font-size: 11.43px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/HTTP%E6%B5%81/" style="font-size: 10px;">HTTP流</a> <a href="/tags/KMP/" style="font-size: 10px;">KMP</a> <a href="/tags/KNN/" style="font-size: 10px;">KNN</a> <a href="/tags/LDA/" style="font-size: 10px;">LDA</a> <a href="/tags/LLE/" style="font-size: 10px;">LLE</a> <a href="/tags/LSA/" style="font-size: 10px;">LSA</a> <a href="/tags/LSM%E6%A0%91/" style="font-size: 10px;">LSM树</a> <a href="/tags/LightHouse/" style="font-size: 10px;">LightHouse</a> <a href="/tags/Linux/" style="font-size: 11.43px;">Linux</a> <a href="/tags/MCP/" style="font-size: 10px;">MCP</a> <a href="/tags/Manacher%E7%AE%97%E6%B3%95/" style="font-size: 10px;">Manacher算法</a> <a href="/tags/NMF/" style="font-size: 10px;">NMF</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/P2P/" style="font-size: 10px;">P2P</a> <a href="/tags/PCA/" style="font-size: 10px;">PCA</a> <a href="/tags/Qwen/" style="font-size: 10px;">Qwen</a> <a href="/tags/RAG/" style="font-size: 11.43px;">RAG</a> <a href="/tags/RDT/" style="font-size: 10px;">RDT</a> <a href="/tags/SLAM/" style="font-size: 10px;">SLAM</a> <a href="/tags/SMTP-POP3-IMAP/" style="font-size: 10px;">SMTP/POP3/IMAP</a> <a href="/tags/ST%E8%A1%A8/" style="font-size: 10px;">ST表</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/tags/WebDAV/" style="font-size: 10px;">WebDAV</a> <a href="/tags/diesel/" style="font-size: 10px;">diesel</a> <a href="/tags/epoll/" style="font-size: 10px;">epoll</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/io%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/" style="font-size: 10px;">io多路复用</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/k-means/" style="font-size: 10px;">k-means</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/python/" style="font-size: 14.29px;">python</a> <a href="/tags/redo-undo%E6%97%A5%E5%BF%97/" style="font-size: 10px;">redo/undo日志</a> <a href="/tags/requests/" style="font-size: 11.43px;">requests</a> <a href="/tags/t-SNE/" style="font-size: 10px;">t-SNE</a> <a href="/tags/tarjan/" style="font-size: 10px;">tarjan</a> <a href="/tags/web%E7%BC%93%E5%AD%98/" style="font-size: 10px;">web缓存</a> <a href="/tags/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" style="font-size: 10px;">中国剩余定理</a> <a href="/tags/%E4%B9%90%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/" style="font-size: 10px;">乐观并发控制</a> <a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 10px;">事务</a> <a href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/" style="font-size: 10px;">二分图匹配</a> <a href="/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/" style="font-size: 10px;">二分答案</a> <a href="/tags/%E4%BC%A0%E8%BE%93%E5%B1%82/" style="font-size: 10px;">传输层</a> <a href="/tags/%E4%BD%8D%E5%9B%BE%E7%B4%A2%E5%BC%95/" style="font-size: 10px;">位图索引</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 11.43px;">动态规划</a> <a href="/tags/%E5%8D%8F%E8%AE%AE%E5%88%86%E5%B1%82/" style="font-size: 10px;">协议分层</a> <a href="/tags/%E5%8F%8C%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" style="font-size: 10px;">双连通分量</a> <a href="/tags/%E5%90%8C%E4%BD%99/" style="font-size: 10px;">同余</a> <a href="/tags/%E5%90%8C%E4%BD%99%E9%80%86%E5%85%83/" style="font-size: 10px;">同余逆元</a> <a href="/tags/%E5%90%8E%E7%BC%80SA/" style="font-size: 10px;">后缀SA</a> <a href="/tags/%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/" style="font-size: 10px;">哈希索引</a> <a href="/tags/%E5%9B%BE%E7%AE%97%E6%B3%95/" style="font-size: 14.29px;">图算法</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size: 14.29px;">图论</a> <a href="/tags/%E5%9F%BA%E7%8E%AF%E6%A0%91/" style="font-size: 10px;">基环树</a> <a href="/tags/%E5%A4%9A%E7%89%88%E6%9C%AC%E6%9C%BA%E5%88%B6/" style="font-size: 10px;">多版本机制</a> <a href="/tags/%E5%A4%9A%E7%BB%B4%E7%B4%A2%E5%BC%95/" style="font-size: 10px;">多维索引</a> <a href="/tags/%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3/" style="font-size: 10px;">多路分解</a> <a href="/tags/%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/" style="font-size: 10px;">多路复用</a> <a href="/tags/%E5%AD%97%E5%85%B8%E6%A0%91/" style="font-size: 10px;">字典树</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 10px;">字符串</a> <a href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" style="font-size: 10px;">容斥原理</a> <a href="/tags/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F/" style="font-size: 10px;">差分约束</a> <a href="/tags/%E5%BA%B7%E6%89%98%E5%B1%95%E5%BC%80/" style="font-size: 10px;">康托展开</a> <a href="/tags/%E5%BC%82%E6%88%96%E5%93%88%E5%B8%8C/" style="font-size: 10px;">异或哈希</a> <a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 10px;">异步</a> <a href="/tags/%E5%BC%BA%E8%81%94%E9%80%9A%E5%88%86%E9%87%8F/" style="font-size: 11.43px;">强联通分量</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2FFT/" style="font-size: 10px;">快速傅里叶变换FFT</a> <a href="/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" style="font-size: 10px;">快速幂</a> <a href="/tags/%E6%82%B2%E8%A7%82%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/" style="font-size: 10px;">悲观并发控制</a> <a href="/tags/%E6%8E%A5%E5%85%A5%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">接入技术</a> <a href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" style="font-size: 10px;">支持向量机</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 17.14px;">数据库</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8/" style="font-size: 10px;">数据库存储</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/" style="font-size: 15.71px;">数据库实验</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 10px;">数论</a> <a href="/tags/%E6%97%B6%E9%97%B4%E6%88%B3%E6%8E%92%E5%BA%8F%E6%9C%BA%E5%88%B6/" style="font-size: 10px;">时间戳排序机制</a> <a href="/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/" style="font-size: 10px;">最大流</a> <a href="/tags/%E6%9C%80%E5%B0%8F%E5%89%B2/" style="font-size: 10px;">最小割</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/" style="font-size: 10px;">最短路径</a> <a href="/tags/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/" style="font-size: 10px;">朴素贝叶斯</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 17.14px;">机器学习</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%A6%81/" style="font-size: 10px;">机器学习概要</a> <a href="/tags/%E6%9E%81%E8%A7%92%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">极角排序</a> <a href="/tags/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/" style="font-size: 10px;">查询优化</a> <a href="/tags/%E6%9F%A5%E8%AF%A2%E5%A4%84%E7%90%86/" style="font-size: 10px;">查询处理</a> <a href="/tags/%E6%9F%A5%E8%AF%A2%E6%89%A7%E8%A1%8C/" style="font-size: 10px;">查询执行</a> <a href="/tags/%E6%A0%91%E4%B8%8A%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/" style="font-size: 10px;">树上启发式合并</a> <a href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" style="font-size: 10px;">树状数组</a> <a href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" style="font-size: 10px;">树链剖分</a> <a href="/tags/%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/" style="font-size: 10px;">根号分治</a> <a href="/tags/%E6%AD%A3%E5%88%99%E5%8C%96/" style="font-size: 10px;">正则化</a> <a href="/tags/%E6%AF%8D%E5%87%BD%E6%95%B0/" style="font-size: 10px;">母函数</a> <a href="/tags/%E6%B7%B7%E5%90%88%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/" style="font-size: 10px;">混合高斯分布</a> <a href="/tags/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/" style="font-size: 11.43px;">源码阅读</a> <a href="/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/" style="font-size: 10px;">状态压缩</a> <a href="/tags/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6/" style="font-size: 10px;">电子邮件</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">矩阵</a> <a href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">神经网络</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" style="font-size: 10px;">线性回归</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size: 10px;">线段树</a> <a href="/tags/%E7%BB%84%E5%90%88%E5%8D%9A%E5%BC%88/" style="font-size: 10px;">组合博弈</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">网络</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/" style="font-size: 12.86px;">网络流</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" style="font-size: 10px;">背包问题</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" style="font-size: 10px;">莫比乌斯反演</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size: 10px;">计算几何</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 18.57px;">计算机网络</a> <a href="/tags/%E8%B4%AA%E5%BF%83/" style="font-size: 10px;">贪心</a> <a href="/tags/%E8%B4%B9%E7%94%A8%E6%B5%81/" style="font-size: 10px;">费用流</a> <a href="/tags/%E9%80%92%E6%8E%A8/" style="font-size: 10px;">递推</a> <a href="/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/" style="font-size: 10px;">逻辑回归</a> <a href="/tags/%E9%94%81%E6%9C%BA%E5%88%B6/" style="font-size: 10px;">锁机制</a> <a href="/tags/%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97/" style="font-size: 10px;">随机森林</a>
                </div>
            </div>
        </section>
        <section class="sub-footer">
            <p>© 2025 <a href="/">Mai Icy</a>. All Rights Reserved. Theme By <a href="https://github.com/Dreamer-Paul/Hingle" target="_blank" rel="nofollow">Hingle</a>.</p>
        </section>
    </div>
</footer>


<script src="/static/kico.js"></script>
<script src="/static/hingle.js"></script>


<script>var hingle = new Paul_Hingle({"copyright":true,"night":true});</script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
